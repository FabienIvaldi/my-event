<div *ngIf="errorMessage" class="bg-red-100 text-red-700 p-4 rounded-md mb-4">
    {{ errorMessage }}
</div>


<div class="container mx-auto flex flex-wrap">
    <div class="w-full lg:w-1/4 mb-6 p-2">
        <form (ngSubmit)="applyFilters()" class="border-2 p-5 space-y-4 md:top-4 bg-white shadow-lg rounded-md">
            <input [(ngModel)]="searchTerm" name="searchTerm" placeholder="Rechercher un événement..."
                class="w-full p-2 border border-gray-300 rounded-md">

            <div>
                <label class="block font-medium text-gray-700">Région :</label>
                <select [(ngModel)]="selectedRegion" name="selectedRegion"
                    class="w-full p-2 border border-gray-300 rounded-md">
                    <option value="">Toutes les régions</option>
                    <option *ngFor="let region of uniqueRegions" [value]="region">{{ region }}</option>
                </select>
            </div>

            <div>
                <label class="block font-medium text-gray-700">Département :</label>
                <select [(ngModel)]="selectedDepartment" name="selectedDepartment"
                    class="w-full p-2 border border-gray-300 rounded-md">
                    <option value="">Tous les départements</option>
                    <option *ngFor="let department of uniqueDepartments" [value]="department">{{ department }}</option>
                </select>
            </div>
        </form>
    </div>

    <div class="w-full lg:w-3/4 grid grid-cols-1 gap-6">
        <div *ngFor="let event of filteredEvents()"
            class="bg-white shadow-md hover:shadow-lg transition-shadow duration-300 rounded-lg overflow-hidden flex flex-col lg:flex-row">
            <img [src]="event.image || 'assets/placeholder-290.png'" alt="{{ event.title_fr }}"
                class="w-full lg:w-1/3 h-48 object-cover" (error)="event.image = 'assets/placeholder-290.png'">

            <div class="p-6">
                <a [routerLink]="['/home/', event.slug]"
                    class="text-xl font-semibold text-gray-900 mb-2 hover:text-blue-500 transition-colors duration-300">
                    {{ event.title_fr }}
                </a>
                <p class="text-gray-600 mb-2">
                    <span class="font-medium">Date :</span> {{ event.firstdate_begin | date: 'longDate' }}
                </p>
                <p class="text-gray-600 mb-2">
                    <span class="font-medium">Région :</span> {{ event.location_region || 'aucune données'}}
                </p>
                <p class="text-gray-600 mb-2" *ngIf="event.location_department">
                    <span class="font-medium">Département :</span> {{ event.location_department || 'aucune données'}}
                </p>
                <p class="text-gray-600 truncate">
                    <span class="font-medium">Description :</span> {{ event.description_fr || 'aucune données'}}
                </p>
                <a [routerLink]="['/home/', event.slug]" class="text-blue-500 hover:text-blue-700 mt-4">
                    Voir plus
                </a>
            </div>
        </div>
    </div>
</div>